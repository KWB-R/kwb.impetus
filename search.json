[{"path":"https://kwb-r.github.io/kwb.impetus/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 Kompetenzzentrum Wasser Berlin gGmbH (KWB) Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":[]},{"path":"https://kwb-r.github.io/kwb.impetus/articles/dwd.html","id":"temporal-coverage","dir":"Articles","previous_headings":"","what":"Temporal Coverage","title":"Deutscher Wetterdienst (DWD)","text":"","code":"library(kwb.impetus) dwd_timeperiod <- kwb.impetus::dwd_berlin_monthly %>%     dplyr::group_by(.data$parameter_name,                 .data$parameter) %>%     dplyr::summarise(date_min = min(.data$date),                     date_max = max(.data$date),                     number_of_datapoints = dplyr::n()) %>%     dplyr::mutate(file_postfix = stringr::str_replace_all(.data$parameter, \"_\", \"-\"))  DT::datatable(dwd_timeperiod, caption = \"Monthly DWD Data availability for Berlin\")"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/dwd.html","id":"content","dir":"Articles","previous_headings":"Temporal Coverage","what":"Content","title":"Deutscher Wetterdienst (DWD)","text":"","code":"DT::datatable(kwb.impetus::dwd_berlin_monthly)"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/dwd.html","id":"define-helper-functions","dir":"Articles","previous_headings":"","what":"Define Helper Functions","title":"Deutscher Wetterdienst (DWD)","text":"","code":"summarise_means <- function(data) {   data %>%     dplyr::summarise(       q05 = quantile(.data$mean, probs = 0.05),       q95 = quantile(.data$mean, probs = 0.95),       mean = mean(.data$mean)     )   }  filter_for_parameter <- function(data, parameter_name) {   data[data$parameter_name == parameter_name,] }  filter_for_max_year <- function(data) {   data[data$Year == max(data$Year),] }  aggregate_and_plot <- function(parameter_name, colors, unit = \"mm/month\") {      full_data <- kwb.impetus::dwd_berlin_monthly %>%      filter_for_parameter(parameter_name) %>%       dplyr::mutate(       Year = as.integer(.data$year),        Decade = kwb.impetus::floor_decade(.data$year),       Decade_Label = kwb.impetus::decade_label(.data$Decade),       Month = as.factor(.data$month),       Label = sprintf(\"DWD, monthly '%s'\", parameter_name)     )      aggregated_data <- full_data %>%      kwb.impetus::group_by_decade_month_label() %>%      summarise_means()      decades <- kwb.impetus::decades_tibble(     decade_labels = aggregated_data$Decade_Label,     colors = colors   )      decade_mean_data <- aggregated_data %>%       kwb.impetus::group_by_decade_label() %>%      dplyr::summarise(annual_mean = sum(.data$mean))      # p1 <- aggregated_data %>%   #   dplyr::left_join(decade_mean_data) %>%   #   dplyr::mutate(Decade_Label = sprintf(   #     \"%s\\n%3.1f mm/Jahr)\",   #     .data$Decade_Label,   #     round(.data$annual_mean, 1)   #   ))      p1 <- aggregated_data      p2 <- full_data %>%      filter_for_max_year() %>%      kwb.impetus::group_by_decade_label() %>%      kwb.impetus::group_by_year_month() %>%      summarise_means()      p1 %>%      ggplot2::ggplot(mapping = ggplot2::aes(       x = as.integer(.data$Month),        y = .data$mean,       col = as.factor(.data$Decade_Label)     )) +      #ggplot2::geom_point(alpha = 0.5) +      kwb.impetus::decade_ribbons() +      kwb.impetus::scale_fill_decades(decades) +     kwb.impetus::scale_color_decades(decades) +     ggplot2::geom_point() +     ggplot2::geom_point(ggplot2::aes(       x = as.integer(.data$Month),       y = .data$mean     ),      data = p2,     col = \"darkgrey\",     alpha = 0.5,      inherit.aes = FALSE,     show.legend = FALSE     ) +     kwb.impetus::ggplot2_scale_x_continuous_12() +     #ggplot2::geom_boxplot() +     ggplot2::facet_wrap(        ~ .data$Decade_Label,       nrow = 1L,        ncol = length(unique(p1$Decade_Label))     ) +     ggplot2::theme_bw() +      ggplot2::theme(legend.position = \"bottom\") +     ggplot2::labs(       y = sprintf(\"Mean '%s' (%s)\",                    parameter_name,                    unit),        x = \"Month Number\",        col = \"Mean\",        fill = \"5%/95% Conf.-Interval\",       title = unique(p1$Label)     ) }  print_to_pdf <- function(gg, file, width.cm) {      kwb.utils::preparePdf(     file,      landscape = TRUE,      width.cm = width.cm,      height.cm = 21   )    on.exit(dev.off())      print(gg) }"},{"path":[]},{"path":"https://kwb-r.github.io/kwb.impetus/articles/dwd.html","id":"drought-index","dir":"Articles","previous_headings":"Create Plots","what":"Drought index","title":"Deutscher Wetterdienst (DWD)","text":"","code":"sel_para <- dwd_timeperiod[dwd_timeperiod$parameter == \"drought_index\",] file_name <- sprintf(\"dwd_berlin_monthly_%s\", sel_para$file_postfix) gg <- aggregate_and_plot(parameter_name = sel_para$parameter_name,                           colors = c(   'darkblue', 'blue', 'darkgreen', 'lightgreen', 'orange', 'red' ), unit = \"-\")  readr::write_csv(gg$data, file = sprintf(\"%s.csv\", file_name)) print_to_pdf(gg, file = sprintf(\"%s.pdf\", file_name), width.cm = 50)"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/dwd.html","id":"evaporation-potential","dir":"Articles","previous_headings":"Create Plots","what":"Evaporation, potential","title":"Deutscher Wetterdienst (DWD)","text":"","code":"sel_para <- dwd_timeperiod[dwd_timeperiod$parameter == \"evapo_p\",] file_name <- sprintf(\"dwd_berlin_monthly_%s\", sel_para$file_postfix)  gg <- aggregate_and_plot(parameter_name = sel_para$parameter_name, colors = c(   'darkgreen', 'lightgreen', 'orange', 'red' ))  readr::write_csv(gg$data, file = sprintf(\"%s.csv\", file_name)) print_to_pdf(gg, file = sprintf(\"%s.pdf\", file_name), width.cm = 35)"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/dwd.html","id":"evaporation-real","dir":"Articles","previous_headings":"Create Plots","what":"Evaporation, real","title":"Deutscher Wetterdienst (DWD)","text":"","code":"sel_para <- dwd_timeperiod[dwd_timeperiod$parameter == \"evapo_r\",] file_name <- sprintf(\"dwd_berlin_monthly_%s\", sel_para$file_postfix) gg <- aggregate_and_plot(parameter_name = sel_para$parameter_name, colors = c(   'darkgreen', 'lightgreen', 'orange', 'red' ))  readr::write_csv(gg$data, file = sprintf(\"%s.csv\", file_name)) print_to_pdf(gg, file = sprintf(\"%s.pdf\", file_name), width.cm = 35)"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/dwd.html","id":"precipitation","dir":"Articles","previous_headings":"Create Plots","what":"Precipitation","title":"Deutscher Wetterdienst (DWD)","text":"","code":"sel_para <- dwd_timeperiod[dwd_timeperiod$parameter == \"precipitation\",] file_name <- sprintf(\"dwd_berlin_monthly_%s\", sel_para$file_postfix)  gg <- aggregate_and_plot(parameter_name = sel_para$parameter_name,                           colors = c(   'darkblue', 'blue', 'darkgreen', 'lightgreen', 'orange', 'red' ))  readr::write_csv(gg$data, file = sprintf(\"%s.csv\", file_name)) print_to_pdf(gg, file = sprintf(\"%s.pdf\", file_name), width.cm = 50)"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/dwd.html","id":"soil-moisture","dir":"Articles","previous_headings":"Create Plots","what":"Soil Moisture","title":"Deutscher Wetterdienst (DWD)","text":"","code":"sel_para <- dwd_timeperiod[dwd_timeperiod$parameter == \"soil_moist\",] file_name <- sprintf(\"dwd_berlin_monthly_%s\", sel_para$file_postfix)  gg <- aggregate_and_plot(parameter_name = sel_para$parameter_name, colors = c(   'darkgreen', 'lightgreen', 'orange', 'red' ), unit = \"%\")  readr::write_csv(gg$data, file = sprintf(\"%s.csv\", file_name)) print_to_pdf(gg, file = sprintf(\"%s.pdf\", file_name), width.cm = 35)"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/dwd.html","id":"soil-temperature","dir":"Articles","previous_headings":"Create Plots","what":"Soil Temperature","title":"Deutscher Wetterdienst (DWD)","text":"","code":"sel_para <- dwd_timeperiod[dwd_timeperiod$parameter == \"soil_temperature_5cm\",] file_name <- sprintf(\"dwd_berlin_monthly_%s\", sel_para$file_postfix)  gg <- aggregate_and_plot(parameter_name = sel_para$parameter_name, colors = c(   'darkgreen', 'lightgreen', 'orange', 'red' ), unit = \"\\u00B0 C\")  readr::write_csv(gg$data, file = sprintf(\"%s.csv\", file_name)) print_to_pdf(gg, file = sprintf(\"%s.pdf\", file_name), width.cm = 35)"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/dwd.html","id":"download","dir":"Articles","previous_headings":"","what":"Download","title":"Deutscher Wetterdienst (DWD)","text":"plots created code exported pdf files, available download : character(0) CSV: dwd_berlin_monthly_drought-index.csv dwd_berlin_monthly_evapo-p.csv dwd_berlin_monthly_evapo-r.csv dwd_berlin_monthly_precipitation.csv dwd_berlin_monthly_soil-moist.csv dwd_berlin_monthly_soil-temperature-5cm.csv PDF: dwd_berlin_monthly_drought-index.pdf dwd_berlin_monthly_evapo-p.pdf dwd_berlin_monthly_evapo-r.pdf dwd_berlin_monthly_precipitation.pdf dwd_berlin_monthly_soil-moist.pdf dwd_berlin_monthly_soil-temperature-5cm.pdf","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/articles/dwd_climate-water-balance.html","id":"helper-functions","dir":"Articles","previous_headings":"","what":"Helper Functions","title":"DWD: Climate Water Balance","text":"","code":"library(kwb.impetus) summarise_means <- function(data) {   data %>%     dplyr::summarise(       q05 = quantile(.data$mean, probs = 0.05),       q95 = quantile(.data$mean, probs = 0.95),       mean = mean(.data$mean)     )   }   decade_year_sums <- function(data,                               full_years = TRUE,                              unit = \"mm/a\") {      years <- unique(data$year)      if(full_years) {     years <- data %>%         dplyr::count(Decade, Decade_Label, Year) %>%        dplyr::filter(.data$n == 12) %>%        dplyr::pull(.data$Year)   }      data %>%      dplyr::filter(.data$year %in% years) %>%      dplyr::group_by(Decade, Decade_Label, Year) %>%       dplyr::summarise(mean = sum(mean)) %>%      summarise_means() %>%      dplyr::mutate(Decade_Label_new = sprintf(\"%s\\nq95: %3.1f %s\\nmean: %3.1f %s\\nq05: %3.1f %s\",                                              .data$Decade_Label,                                               .data$q95,                                               unit,                                              .data$mean,                                              unit,                                              .data$q05,                                              unit))    }  filter_for_max_year <- function(data) {   data[data$Year == max(data$Year),] }  plot_yearly <- function(data, y_label) {   data %>%       dplyr::group_by(year) %>%      dplyr::summarise(mean = sum(mean)) %>%      dplyr::mutate(       Year = as.integer(.data$year),        Decade = kwb.impetus::floor_decade(.data$year),       Decade_Label = kwb.impetus::decade_label(.data$Decade)) %>%     ggplot2::ggplot(mapping = ggplot2::aes(x = year,                                             y = mean)) +                       ggplot2::geom_point() +                       ggplot2::geom_line() +     ggplot2::theme_bw() +     ggplot2::labs(x = \"Year\",                    y = sprintf(\"%s (mm/a)\", y_label))   }  plot_decades <- function(data, unit = \"mm/a\") {      decade_sums <- decade_year_sums(data) %>%      dplyr::ungroup() %>%      dplyr::select(Decade_Label,                    Decade_Label_new)         aggregated_data <- data %>%      kwb.impetus::group_by_decade_month_label() %>%      summarise_means() %>%      dplyr::ungroup() %>%      dplyr::left_join(decade_sums, by = \"Decade_Label\") %>%      dplyr::select(-.data$Decade_Label) %>%      dplyr::rename(Decade_Label = .data$Decade_Label_new)         decades <- kwb.impetus::decades_tibble(     decade_labels = aggregated_data$Decade_Label,     colors = c('darkgreen', 'lightgreen', 'orange', 'red')   )      p1 <- aggregated_data      p2 <- data %>%      filter_for_max_year() %>%      kwb.impetus::group_by_decade_label() %>%      kwb.impetus::group_by_year_month() %>%      summarise_means()      p1 %>%      ggplot2::ggplot(mapping = ggplot2::aes(       x = as.integer(.data$Month),        y = .data$mean,       col = as.factor(.data$Decade_Label)     )) +      #ggplot2::geom_point(alpha = 0.5) +      kwb.impetus::decade_ribbons() +     kwb.impetus::scale_fill_decades(decades) +     kwb.impetus::scale_color_decades(decades) +     ggplot2::geom_point() +     ggplot2::geom_point(ggplot2::aes(       x = as.integer(.data$Month),       y = .data$mean     ),     data = p2,     col = \"darkgrey\",     alpha = 0.5,     inherit.aes = FALSE,     show.legend = FALSE     ) +     kwb.impetus::ggplot2_scale_x_continuous_12() +     #ggplot2::geom_boxplot() +     ggplot2::facet_wrap(        ~ .data$Decade_Label,       nrow = 1L,        ncol = length(unique(p1$Decade_Label))     ) +     ggplot2::theme_bw() +      ggplot2::theme(legend.position = \"bottom\") +     ggplot2::labs(       y = sprintf(\"Mean '%s' (%s)\",                    parameter_name,                    unit),        x = \"Month Number\",        col = \"Mean\",        fill = \"5%/95% Conf.-Interval\",       title = unique(p1$Label)     ) }   print_to_pdf <- function(gg, file, width.cm) {      kwb.utils::preparePdf(     file,      landscape = TRUE,      width.cm = width.cm,      height.cm = 21   )      on.exit(dev.off())      print(gg) }"},{"path":[]},{"path":"https://kwb-r.github.io/kwb.impetus/articles/dwd_climate-water-balance.html","id":"precipitation---evaporation-potential","dir":"Articles","previous_headings":"Climate Water Balance","what":"Precipitation - Evaporation, potential","title":"DWD: Climate Water Balance","text":"Year Decade","code":"parameter_name <- \"Precipitation - Evaporation, real\" parameter_id <- \"evapo_p\" file_name_base <- sprintf(\"precipitation-%s_\", parameter_id)  data <- kwb.impetus::dwd_berlin_monthly %>%     dplyr::select(parameter, date, year, month, mean) %>%    dplyr::filter(parameter %in% c(\"precipitation\", parameter_id)) %>%    tidyr::pivot_wider(names_from = \"parameter\",                       values_from = \"mean\") %>%    dplyr::mutate(     Year = as.integer(.data$year),      Decade = kwb.impetus::floor_decade(.data$year),     Decade_Label = kwb.impetus::decade_label(.data$Decade),     Month = as.factor(.data$month),     Label = sprintf(\"DWD, monthly '%s'\", parameter_name),     mean = .data$precipitation - .data[[parameter_id]]   ) %>%    dplyr::filter(!is.na(mean)) %>%    dplyr::select(- .data$precipitation,                  - .data[[parameter_id]]) #> Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. #> ℹ Please use `\"precipitation\"` instead of `.data$precipitation` #> Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. #> ℹ Please use `all_of(var)` (or `any_of(var)`) instead of `.data[[var]]` gg1 <- plot_yearly(data, y_label = parameter_name) plotly::ggplotly(gg1) DT::datatable(decade_year_sums(data)[,-6]) #> `summarise()` has grouped output by 'Decade', 'Decade_Label'. You can override #> using the `.groups` argument. #> `summarise()` has grouped output by 'Decade'. You can override using the #> `.groups` argument. gg2 <- plot_decades(data) #> `summarise()` has grouped output by 'Decade', 'Decade_Label'. You can override #> using the `.groups` argument. #> `summarise()` has grouped output by 'Decade'. You can override using the #> `.groups` argument. #> `summarise()` has grouped output by 'Decade', 'Decade_Label', 'Month'. You can #> override using the `.groups` argument. #> Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. #> ℹ Please use `\"Decade_Label\"` instead of `.data$Decade_Label` #> Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. #> ℹ Please use `\"Decade_Label_new\"` instead of `.data$Decade_Label_new` #> `summarise()` has grouped output by 'Year'. You can override using the #> `.groups` argument. print_to_pdf(gg2,              file = sprintf(\"%sdecades.pdf\", file_name_base),               width.cm = 35)"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/dwd_climate-water-balance.html","id":"precipitation---evaporation-real","dir":"Articles","previous_headings":"Climate Water Balance","what":"Precipitation - Evaporation, real","title":"DWD: Climate Water Balance","text":"Year Decade","code":"parameter_name <- \"Precipitation - Evaporation, real\" parameter_id <- \"evapo_r\" file_name_base <- sprintf(\"precipitation-%s_\", parameter_id)  data <- kwb.impetus::dwd_berlin_monthly %>%     dplyr::select(parameter, date, year, month, mean) %>%    dplyr::filter(parameter %in% c(\"precipitation\", parameter_id)) %>%    tidyr::pivot_wider(names_from = \"parameter\",                       values_from = \"mean\") %>%    dplyr::mutate(     Year = as.integer(.data$year),      Decade = kwb.impetus::floor_decade(.data$year),     Decade_Label = kwb.impetus::decade_label(.data$Decade),     Month = as.factor(.data$month),     Label = sprintf(\"DWD, monthly '%s'\", parameter_name),     mean = .data$precipitation - .data[[parameter_id]]   ) %>%    dplyr::filter(!is.na(mean)) %>%    dplyr::select(- .data$precipitation,                  - .data[[parameter_id]]) gg1 <- plot_yearly(data, y_label = parameter_name) plotly::ggplotly(gg1) DT::datatable(decade_year_sums(data)[,-6]) #> `summarise()` has grouped output by 'Decade', 'Decade_Label'. You can override #> using the `.groups` argument. #> `summarise()` has grouped output by 'Decade'. You can override using the #> `.groups` argument. gg2 <- plot_decades(data) #> `summarise()` has grouped output by 'Decade', 'Decade_Label'. You can override #> using the `.groups` argument. #> `summarise()` has grouped output by 'Decade'. You can override using the #> `.groups` argument. #> `summarise()` has grouped output by 'Decade', 'Decade_Label', 'Month'. You can #> override using the `.groups` argument. #> `summarise()` has grouped output by 'Year'. You can override using the #> `.groups` argument. print_to_pdf(gg2,              file = sprintf(\"%sdecades.pdf\", file_name_base),               width.cm = 35)"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/dwd_climate-water-balance.html","id":"download","dir":"Articles","previous_headings":"","what":"Download","title":"DWD: Climate Water Balance","text":"plots created code exported pdf files, available download : PDF: precipitation-evapo_p_decades.pdf precipitation-evapo_p_yearly.pdf precipitation-evapo_r_decades.pdf precipitation-evapo_r_yearly.pdf","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/articles/gfz_geological-model-berlin.html","id":"define-paths","dir":"Articles","previous_headings":"","what":"Define Paths","title":"GFZ: 3D Geological Model of Berlin","text":"","code":"library(kwb.impetus)  paths_list <- list(   base_url = \"https://datapub.gfz-potsdam.de/download/10.5880.GFZ.4.5.2020.005nuirg\",   dataset = \"<base_url>/2020-005_Frick-et-al_Berlin-Model_data.zip\",    metadata = \"<base_url>/2020-005_Frick-et-al_Berlin-Model_data-description.pdf\",   model_data = \"model_gfz\" )  paths <- kwb.utils::resolve(paths_list)"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/gfz_geological-model-berlin.html","id":"download","dir":"Articles","previous_headings":"","what":"Download","title":"GFZ: 3D Geological Model of Berlin","text":"Download GFZ Model Dataset (2020-005_Frick-et-al_Berlin-Model_data.zip). Metadata available : (2020-005_Frick-et-al_Berlin-Model_data-description.pdf)","code":"# archive::archive_extract(archive = paths$dataset,  #                          dir = paths$model_data)  kwb.impetus::download_gfz_model(target_dir = paths$model_data) #> ⠙ 5 extracted |  40 MB (8.4 MB/s) | 4.8s #> ⠹ 10 extracted |  91 MB ( 11 MB/s) | 8s #> ⠸ 14 extracted | 125 MB ( 11 MB/s) | 11.1s #> ⠼ 17 extracted | 157 MB ( 11 MB/s) | 14.2s #> ⠴ 20 extracted | 191 MB ( 11 MB/s) | 17.4s #> ⠦ 24 extracted | 225 MB ( 11 MB/s) | 20.5s #> ⠧ 27 extracted | 258 MB ( 11 MB/s) | 23.7s #> ⠇ 31 extracted | 295 MB ( 11 MB/s) | 26.8s #> ⠏ 35 extracted | 330 MB ( 11 MB/s) | 29.9s #> ⠋ 38 extracted | 364 MB ( 11 MB/s) | 33s #> ⠙ 42 extracted | 396 MB ( 11 MB/s) | 36.1s #> ⠹ 46 extracted | 431 MB ( 11 MB/s) | 39.2s"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/gfz_geological-model-berlin.html","id":"import","dir":"Articles","previous_headings":"","what":"Import","title":"GFZ: 3D Geological Model of Berlin","text":"","code":"elevation <- kwb.impetus::read_gfz_layers(paths$model_data, type = \"elevation\") #> Reading (1/24): 'model_gfz/1_Holocene_elevation.dat' ... ok. (1.43s)  #> Reading (2/24): 'model_gfz/10_Lower_Cretaceous_elevation.dat' ... ok. (1.31s)  #> Reading (3/24): 'model_gfz/11_Jurassic_elevation.dat' ... ok. (1.39s)  #> Reading (4/24): 'model_gfz/12_Keuper_elevation.dat' ... ok. (1.08s)  #> Reading (5/24): 'model_gfz/13_Muschelkalk_elevation.dat' ... ok. (1.12s)  #> Reading (6/24): 'model_gfz/14_Upper_Buntsandstein_elevation.dat' ... ok. (1.11s)  #> Reading (7/24): 'model_gfz/15_Middle_Buntsandstein_elevation.dat' ... ok. (1.31s)  #> Reading (8/24): 'model_gfz/16_Lower_Buntsandstein_elevation.dat' ... ok. (1.12s)  #> Reading (9/24): 'model_gfz/17_Zechstein_elevation.dat' ... ok. (1.36s)  #> Reading (10/24): 'model_gfz/18_Rotliegend_elevation.dat' ... ok. (1.08s)  #> Reading (11/24): 'model_gfz/19_Permo-Carboniferous_elevation.dat' ... ok. (1.08s)  #> Reading (12/24): 'model_gfz/2_Saalian_elevation.dat' ... ok. (1.10s)  #> Reading (13/24): 'model_gfz/20_Pre-Permian_elevation.dat' ... ok. (1.11s)  #> Reading (14/24): 'model_gfz/21_Upper_Crust_elevation.dat' ... ok. (1.42s)  #> Reading (15/24): 'model_gfz/22_Lower_Crust_elevation.dat' ... ok. (1.04s)  #> Reading (16/24): 'model_gfz/23_Upper_Mantle_elevation.dat' ... ok. (1.00s)  #> Reading (17/24): 'model_gfz/24_LAB_elevation.dat' ... ok. (1.36s)  #> Reading (18/24): 'model_gfz/3_Holstein_elevation.dat' ... ok. (1.10s)  #> Reading (19/24): 'model_gfz/4_Elsterian_elevation.dat' ... ok. (1.12s)  #> Reading (20/24): 'model_gfz/5_Miocene_elevation.dat' ... ok. (1.08s)  #> Reading (21/24): 'model_gfz/6_Cottbus_elevation.dat' ... ok. (1.21s)  #> Reading (22/24): 'model_gfz/7_Rupelian_elevation.dat' ... ok. (1.41s)  #> Reading (23/24): 'model_gfz/8_Pre-Rupelian_elevation.dat' ... ok. (1.25s)  #> Reading (24/24): 'model_gfz/9_Upper_Cretaceous_elevation.dat' ... ok. (1.01s) thickness <- kwb.impetus::read_gfz_layers(paths$model_data, type = \"thickness\") #> Reading (1/23): 'model_gfz/1_Holocene_thickness.dat' ... ok. (1.09s)  #> Reading (2/23): 'model_gfz/10_Lower_Cretaceous_thickness.dat' ... ok. (1.39s)  #> Reading (3/23): 'model_gfz/11_Jurassic_thickness.dat' ... ok. (1.06s)  #> Reading (4/23): 'model_gfz/12_Keuper_thickness.dat' ... ok. (1.64s)  #> Reading (5/23): 'model_gfz/13_Muschelkalk_thickness.dat' ... ok. (1.13s)  #> Reading (6/23): 'model_gfz/14_Upper_Buntsandstein_thickness.dat' ... ok. (1.18s)  #> Reading (7/23): 'model_gfz/15_Middle_Buntsandstein_thickness.dat' ... ok. (1.22s)  #> Reading (8/23): 'model_gfz/16_Lower_Buntsandstein_thickness.dat' ... ok. (1.15s)  #> Reading (9/23): 'model_gfz/17_Zechstein_thickness.dat' ... ok. (1.21s)  #> Reading (10/23): 'model_gfz/18_Rotliegend_thickness.dat' ... ok. (1.28s)  #> Reading (11/23): 'model_gfz/19_Permo-Carboniferous_thickness.dat' ... ok. (1.27s)  #> Reading (12/23): 'model_gfz/2_Saalian_thickness.dat' ... ok. (1.02s)  #> Reading (13/23): 'model_gfz/20_Pre-Permian_thickness.dat' ... ok. (0.97s)  #> Reading (14/23): 'model_gfz/21_Upper_Crust_thickness.dat' ... ok. (1.24s)  #> Reading (15/23): 'model_gfz/22_Lower_Crust_thickness.dat' ... ok. (0.86s)  #> Reading (16/23): 'model_gfz/23_Upper_Mantle_thickness.dat' ... ok. (1.07s)  #> Reading (17/23): 'model_gfz/3_Holstein_thickness.dat' ... ok. (1.27s)  #> Reading (18/23): 'model_gfz/4_Elsterian_thickness.dat' ... ok. (1.28s)  #> Reading (19/23): 'model_gfz/5_Miocene_thickness.dat' ... ok. (1.54s)  #> Reading (20/23): 'model_gfz/6_Cottbus_thickness.dat' ... ok. (0.86s)  #> Reading (21/23): 'model_gfz/7_Rupelian_thickness.dat' ... ok. (0.91s)  #> Reading (22/23): 'model_gfz/8_Pre-Rupelian_thickness.dat' ... ok. (0.97s)  #> Reading (23/23): 'model_gfz/9_Upper_Cretaceous_thickness.dat' ... ok. (0.91s)  ## Available Layers names(elevation) #>  [1] \"1_Holocene\"              \"10_Lower_Cretaceous\"     #>  [3] \"11_Jurassic\"             \"12_Keuper\"               #>  [5] \"13_Muschelkalk\"          \"14_Upper_Buntsandstein\"  #>  [7] \"15_Middle_Buntsandstein\" \"16_Lower_Buntsandstein\"  #>  [9] \"17_Zechstein\"            \"18_Rotliegend\"           #> [11] \"19_Permo-Carboniferous\"  \"2_Saalian\"               #> [13] \"20_Pre-Permian\"          \"21_Upper_Crust\"          #> [15] \"22_Lower_Crust\"          \"23_Upper_Mantle\"         #> [17] \"24_LAB\"                  \"3_Holstein\"              #> [19] \"4_Elsterian\"             \"5_Miocene\"               #> [21] \"6_Cottbus\"               \"7_Rupelian\"              #> [23] \"8_Pre-Rupelian\"          \"9_Upper_Cretaceous\" names(thickness) #>  [1] \"1_Holocene\"              \"10_Lower_Cretaceous\"     #>  [3] \"11_Jurassic\"             \"12_Keuper\"               #>  [5] \"13_Muschelkalk\"          \"14_Upper_Buntsandstein\"  #>  [7] \"15_Middle_Buntsandstein\" \"16_Lower_Buntsandstein\"  #>  [9] \"17_Zechstein\"            \"18_Rotliegend\"           #> [11] \"19_Permo-Carboniferous\"  \"2_Saalian\"               #> [13] \"20_Pre-Permian\"          \"21_Upper_Crust\"          #> [15] \"22_Lower_Crust\"          \"23_Upper_Mantle\"         #> [17] \"3_Holstein\"              \"4_Elsterian\"             #> [19] \"5_Miocene\"               \"6_Cottbus\"               #> [21] \"7_Rupelian\"              \"8_Pre-Rupelian\"          #> [23] \"9_Upper_Cretaceous\"  ## Dataset Structure  #str(elevation) #str(thickness)"},{"path":[]},{"path":"https://kwb-r.github.io/kwb.impetus/articles/gfz_geological-model-berlin.html","id":"layer-thickness","dir":"Articles","previous_headings":"Plot","what":"Layer Thickness","title":"GFZ: 3D Geological Model of Berlin","text":"","code":"t_01 <- kwb.impetus::plot_gfz_layer(thickness$`1_Holocene`) #> Warning: cannot handle curvilinear or sheared stars images. Rendering regular #> grid. htmlwidgets::saveWidget(t_01, file = \"thickness_01-holocene.html\")"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/gfz_geological-model-berlin.html","id":"layer-elevation","dir":"Articles","previous_headings":"Plot","what":"Layer Elevation","title":"GFZ: 3D Geological Model of Berlin","text":"","code":"e_01 <- kwb.impetus::plot_gfz_layer(elevation$`1_Holocene`) #> Warning: cannot handle curvilinear or sheared stars images. Rendering regular #> grid. htmlwidgets::saveWidget(e_01,                          file = \"elevation_01-holocene.html\")"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/gfz_geological-model-berlin.html","id":"leaflet-full-page-plots","dir":"Articles","previous_headings":"Plot","what":"Leaflet Full Page Plots","title":"GFZ: 3D Geological Model of Berlin","text":"Elevation: elevation_01-holocene.html Tickness: thickness_01-holocene.html","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/articles/infographic_annual-report.html","id":"define-helper-functions","dir":"Articles","previous_headings":"","what":"Define Helper Functions","title":"Infographic (KWB Annual Report)","text":"","code":"m3_to_million_m3 <- function (values) {   round(values / 1000000, 1) } m3_per_year_in_m3_per_second <- function(values) {   round(values / 365 / 24 / 3600,1) }"},{"path":[]},{"path":"https://kwb-r.github.io/kwb.impetus/articles/infographic_annual-report.html","id":"prepare","dir":"Articles","previous_headings":"Dataset","what":"Prepare","title":"Infographic (KWB Annual Report)","text":"","code":"library(kwb.impetus)  ### Surface water inflows to Berlin kwb.impetus::q_surface_water #> # A tibble: 6 × 10 #>   fliess…¹ pegel mq.19…² mnq.1…³ nq.19…⁴ nnq.v…⁵ nnq.d…⁶ mq.2018 mq.2019 mq.2020 #>   <chr>    <chr>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>   <dbl>   <dbl> #> 1 Dahme    Neue…    9.13    0.69    0.2     0.03 1954-0…   11.4     4.38    2.82 #> 2 Oder-Sp… Wern…    7.9     0.95    0.54    0.1  1905-0…    5.44    2.95    2.64 #> 3 Spree    Groß…   12.3     3.04    1.01    1.01 2001-0…    9.37    9.33    9.03 #> 4 Havel    Borg…   12.3     2.69    1.7     1.66 2009-0…   16.9     6.97    7.71 #> 5 Wuhle    Am B…    0.51    0.23    0.06    0.06 2014-0…    0.3     0.16    0.17 #> 6 Freders… Hege…    0.2     0       0       0    NA         0       0       0    #> # … with abbreviated variable names ¹​fliessgewaesser, ²​mq.1991_2017, #> #   ³​mnq.1991_2017, ⁴​nq.1991_2017, ⁵​nnq.value, ⁶​nnq.date  surface_inflows <- kwb.impetus::q_surface_water %>%   dplyr::select(tidyselect::starts_with(\"mq.\")) %>%   dplyr::summarise(dplyr::across(.fns = sum)) zufluesse <- surface_inflows %>%   tidyr::pivot_longer(     names_to = \"parameter\",     values_to = \"m3_per_second\",     cols = tidyselect::everything()   ) %>%   dplyr::mutate(     million_m3.per_year =  .data$m3_per_second * 365 * 3600 * 24 / 1000000,     parameter = .data$parameter %>%       stringr::str_replace(\"mq.\", \"Mittlerer Oberflächenwasserzufluss (\") %>%       stringr::str_replace(\"_\", \"-\") %>%       stringr::str_c(\")\")   ) %>%   dplyr::mutate(referenz = \"https://www.berlin.de/sen/uvk/_assets/umwelt/wasser-und-geologie/niedrigwasser/niedrigwasser_berlin_2018-2020.pdf#page=16\")    ### https://www.bundestag.de/resource/blob/700220/9e2b154d8c50f289702d6ee82cef0cbe/PPT-Socher-data.pdf#page=18 suempfungswaesser <- tibble::tibble(   parameter = \"Sümpfungswässer (Lausitzer Revier)\",   million_m3.per_year = 144,   m3_per_second = m3_per_year_in_m3_per_second(.data$million_m3.per_year *                                                  1E6),   referenz = \"https://www.bundestag.de/resource/blob/700220/9e2b154d8c50f289702d6ee82cef0cbe/PPT-Socher-data.pdf#page=18\" )  randbedingungen_extern <-   list(Suempfungswaesser = suempfungswaesser,        Zufluesse = zufluesse) %>% dplyr::bind_rows() %>%   dplyr::relocate(.data$parameter) #> Warning: Use of .data in tidyselect expressions was deprecated in tidyselect 1.2.0. #> ℹ Please use `\"parameter\"` instead of `.data$parameter`  crs_target <- 4326  berlin <-   kwb.fisbroker::read_wfs(dataset_id = \"s_wfs_alkis_land\") %>%   sf::st_transform(crs = crs_target) #> Importing WFS dataset_id 's_wfs_alkis_land' from FIS-Broker ... ok. (1.75s)   ### Water Balance (ABIMO 2017) from FIS-Broker gwneu2017 <-   kwb.fisbroker::read_wfs(dataset_id = \"s02_17gwneu2017\") %>%   sf::st_transform(crs = crs_target) #> Importing WFS dataset_id 's02_17gwneu2017' from FIS-Broker ... ok. (15.81s)  ## ohne Strassenflaechen sum(sf::st_area(gwneu2017)) #> 737448657 [m^2]  ## mit Strassenflaechen sum(gwneu2017$flaeche) #> [1] 837255554   ## Wasserflaechen area_water <-   as.numeric(sf::st_area(berlin)) - sum(gwneu2017$flaeche)  ### potential evaporation (for Wasserflaechen)  dwd.1991_2017 <- kwb.impetus::dwd_berlin_monthly %>%   dplyr::filter(parameter %in% c(\"evapo_r\", \"evapo_p\", \"precipitation\"),                 year >= 1991,                 year <= 2017) %>%   dplyr::group_by(parameter, year) %>%   dplyr::summarise(value = sum(.data$mean)) %>%   dplyr::ungroup() %>%   dplyr::group_by(parameter) %>%   dplyr::summarise(value = mean(.data$value)) %>%   tidyr::pivot_wider(names_from = parameter, values_from = value) #> `summarise()` has grouped output by 'parameter'. You can override using the #> `.groups` argument.   ## ABIMO Mass Balance Error  ## Regen, Unkorrigiert (x 1.09) regen_unkor_mm <-   sum(gwneu2017$regenja * gwneu2017$flaeche) / sum(gwneu2017$flaeche)  regen_kor_mm <-   sum((gwneu2017$verdunstun + gwneu2017$row + gwneu2017$ri) * gwneu2017$flaeche) /   sum(gwneu2017$flaeche) regen_kor_mm #> [1] 622.4107  regen_korrektur_faktor <- regen_kor_mm / regen_unkor_mm  regen_kor_m3 <- regen_kor_mm / 1000 * sum(gwneu2017$flaeche)   regen <- tibble::tibble(   mm.per_year = round(regen_kor_mm, 0),   million_m3.per_year = m3_to_million_m3(regen_kor_m3),   m3_per_second = m3_per_year_in_m3_per_second(regen_kor_m3) )   verdunstung_m3 <- sum(gwneu2017$verdunstun / 1000 * gwneu2017$flaeche) verdunstung_m3 # m3/Jahr #> [1] 307820020 m3_per_year_in_m3_per_second(verdunstung_m3) # m3/s #> [1] 9.8  verdunstung_mm <-   sum(gwneu2017$verdunstun * gwneu2017$flaeche) / sum(gwneu2017$flaeche) verdunstung_mm # mm/Jahr #> [1] 367.6536  verdunstung <- tibble::tibble(   mm.per_year = round(verdunstung_mm, 0),   million_m3.per_year = m3_to_million_m3(verdunstung_m3),   m3_per_second = m3_per_year_in_m3_per_second(verdunstung_m3) )   oberflaechenabfluss_m3 <-   sum(gwneu2017$row / 1000 * gwneu2017$flaeche) oberflaechenabfluss_m3 # m3/Jahr #> [1] 71796279 m3_per_year_in_m3_per_second(oberflaechenabfluss_m3) # m3/s #> [1] 2.3  oberflaechenabfluss_mm <-   sum(gwneu2017$row * gwneu2017$flaeche) / sum(gwneu2017$flaeche) oberflaechenabfluss_mm # mm/Jahr #> [1] 85.75193  oberflaechenabfluss <- tibble::tibble(   mm.per_year = round(oberflaechenabfluss_mm, 0),   million_m3.per_year = m3_to_million_m3(oberflaechenabfluss_m3),   m3_per_second = m3_per_year_in_m3_per_second(oberflaechenabfluss_m3) )   interflow_m3 <-   sum((gwneu2017$ri - gwneu2017$ri_k) / 1000 * gwneu2017$flaeche) interflow_mm <-   sum((gwneu2017$ri - gwneu2017$ri_k) * gwneu2017$flaeche) / sum(gwneu2017$flaeche)  zwischenabfluss <- tibble::tibble(   mm.per_year = round(interflow_mm, 0),   million_m3.per_year = m3_to_million_m3(interflow_m3),   m3_per_second = m3_per_year_in_m3_per_second(interflow_m3) )  gwn_m3 <- sum(gwneu2017$ri_k / 1000 * gwneu2017$flaeche) gwn_mm <-   sum(gwneu2017$ri_k * gwneu2017$flaeche) / sum(gwneu2017$flaeche)   gwn <- tibble::tibble(   mm.per_year = round(gwn_mm, 0),   million_m3.per_year = m3_to_million_m3(gwn_m3),   m3_per_second = m3_per_year_in_m3_per_second(gwn_m3) )   wasserhaushalt_berlin <- dplyr::bind_rows(regen,                                           verdunstung,  .id = \"parameter\") %>%   dplyr::bind_rows(oberflaechenabfluss, .id = \"parameter\") %>%   dplyr::bind_rows(zwischenabfluss, .id = \"parameter\") %>%   dplyr::bind_rows(gwn, .id = \"parameter\") %>%   dplyr::mutate(referenz = \"https://fbinter.stadt-berlin.de/fb/berlin/service_intern.jsp?id=s02_17gwneu2017@senstadt&type=WFS&type=WFS\")   wasserhaushalt_berlin$parameter <- c(   \"Regen\",   \"Verdunstung\",   \"Oberflächenabfluss\",   \"Zwischenabfluss\",   \"Grundwasserneubildung\" )   ### Effektive Verdunstungsverluste ueber Wasserflaechen (Millionen m3/a) ### to do: do on monthly basis ! wasserbilanz_gewaesser <- tibble::tibble(   verdunstung.mm = 775,   # default Wert ABIMO Gewaesserverdunstung,   regen.mm = regen_kor_mm,   wasserflaeche.m2 = area_water,   verdunstung.m3_per_year = verdunstung.mm * wasserflaeche.m2 / 1000,   regen.m3_per_year = regen.mm * wasserflaeche.m2 / 1000,   regen.m3_per_second = m3_per_year_in_m3_per_second(regen.m3_per_year),   verdunstung.m3_per_second = m3_per_year_in_m3_per_second(verdunstung.m3_per_year) ) %>%   tidyr::pivot_longer(names_to = \"parameter.einheit\",                       values_to = \"value\",                       tidyselect::everything())  randbedingungen_intern.2021 <- tibble::tibble(   trinkwasserfoerderung.million_m3 = 215,   trinkwasserfoerderung.m3_per_second = m3_per_year_in_m3_per_second(.data$trinkwasserfoerderung.million_m3 *                                                                        1E6),   abwassermenge.million_m3 = 260,   abwassermenge.m3_per_second = m3_per_year_in_m3_per_second(.data$abwassermenge.million_m3 *                                                                1E6),   uferfiltratsanteil.prozent = 54,   #https://www.bwb.de/de/assets/downloads/wvk2040_pk.pdf#page=5   kuenstliche_grundwasseranreicherung.prozent = 14,   #https://www.bwb.de/de/assets/downloads/wvk2040_pk.pdf#page=5   landseitiges_grundwasser.prozent = 100 - .data$uferfiltratsanteil.prozent - kuenstliche_grundwasseranreicherung.prozent,   uferfiltratsanteil.million_m3 = trinkwasserfoerderung.million_m3 * uferfiltratsanteil.prozent /     100,   uferfiltratsanteil.m3_per_second = m3_per_year_in_m3_per_second(.data$uferfiltratsanteil.million_m3 *                                                                     1E6),   kuenstliche_grundwasseranreicherung.million_m3 = trinkwasserfoerderung.million_m3 * kuenstliche_grundwasseranreicherung.prozent /     100,   kuenstliche_grundwasseranreicherung.m3_per_second = m3_per_year_in_m3_per_second(.data$kuenstliche_grundwasseranreicherung.million_m3 *                                                                                      1E6),   landseitiges_grundwasser.million_m3 = trinkwasserfoerderung.million_m3 * landseitiges_grundwasser.prozent /     100,   landseitiges_grundwasser.m3_per_second = m3_per_year_in_m3_per_second(.data$landseitiges_grundwasser.million_m3 *                                                                           1E6) ) %>%   tidyr::pivot_longer(names_to = \"parameter.einheit\",                       values_to = \"value\",                       tidyselect::everything()) %>%   tidyr::separate(parameter.einheit,                   into = c(\"parameter\", \"einheit\"),                   sep = \"\\\\.\") %>%   dplyr::arrange(.data$einheit,                  dplyr::desc(.data$value))  flows <- list(   randbedingungen_extern = randbedingungen_extern,   wasserhaushalt_berlin = wasserhaushalt_berlin,   wasserbilanz_gewaesser = wasserbilanz_gewaesser,   randbedingungen_intern.2021 = randbedingungen_intern.2021 )"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/infographic_annual-report.html","id":"export","dir":"Articles","previous_headings":"Dataset","what":"Export","title":"Infographic (KWB Annual Report)","text":"","code":"openxlsx::write.xlsx(flows, \"impetus_flows_v1.0.0.xlsx\")"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/infographic_annual-report.html","id":"download","dir":"Articles","previous_headings":"Dataset","what":"Download","title":"Infographic (KWB Annual Report)","text":"data generated code available download : impetus_flows_v1.0.0.xlsx","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/articles/wasserportal.html","id":"install-r-package","dir":"Articles","previous_headings":"","what":"Install R Package","title":"Wasserportal","text":"","code":"# Enable repository from kwb-r options(repos = c(   kwbr = 'https://kwb-r.r-universe.dev',   CRAN = 'https://cloud.r-project.org')) # Download and install kwb.impetus in R install.packages('kwb.impetus')"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/wasserportal.html","id":"define-helper-functions","dir":"Articles","previous_headings":"","what":"Define Helper Functions","title":"Wasserportal","text":"","code":"library(kwb.impetus)  get_master <- function(stations_df) {      if(\"Betreiber\" %in% names(stations_df)) {     stations_df <- stations_df %>%    dplyr::filter(.data$Betreiber == \"Land Berlin\")    }    urls <- stations_df %>% dplyr::pull(.data$stammdaten_link)  wasserportal::get_wasserportal_masters_data(master_urls = urls) %>%    dplyr::rename(Messstellennummer = .data$Nummer) %>%    dplyr::mutate(Messstellennummer = as.double(.data$Messstellennummer))   }  get_data_name <- function(para_name) {   prefix <- \"\"   if(startsWith(para_name, \"surface\")) {     prefix <- \"daily_\"   }   paste0(prefix, para_name) }  get_master_name <- function(para_name) {   paste0(\"stations_\", para_name) }"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/wasserportal.html","id":"surface-water","dir":"Articles","previous_headings":"","what":"Surface Water","title":"Wasserportal","text":"","code":"stations <- wasserportal::get_stations() variables <- wasserportal::get_surfacewater_variables() variables <- variables[1:2]   # Downloads pre-compiled data (daily updated at 5am UTC)  # from https://kwb-r.github.io/wasserportal/daily_surface_water.<parameter_name>.csv # see also: https://kwb-r.github.io/wasserportal/articles/surface-water.html overview_names <- names(stations$overview_list)  wp_master <- wasserportal::wp_masters_data_to_list(overview_names) wp_data <- wasserportal::wp_timeseries_data_to_list(overview_names)  ### Alternatively: download latest data from Wasserportal Berlin (takes a while) #wp_sw_data <- wasserportal::get_daily_surfacewater_data(stations, variables)  #wp_gw_data <- wasserportal::get_groundwater_data(stations) #wp_data <- c(wp_sw_data, wp_gw_data)"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/wasserportal.html","id":"surface-water-level","dir":"Articles","previous_headings":"Surface Water","what":"Surface Water Level","title":"Wasserportal","text":"","code":"para_name <- \"surface-water_water-level\"  surfacewater_level_master <- wp_data[[get_data_name(para_name)]] %>%    dplyr::filter(.data$Parameter == \"Wasserstand\") %>%     dplyr::mutate(Datum = as.Date(.data$Datum),                 Year = as.integer(format(.data$Datum, \"%Y\")),                  Decade = kwb.impetus::floor_decade(.data$Year),                 Decade_Label = sprintf(\"%d - %d\",                                         .data$Decade,                                         .data$Decade + 9),                 Month = as.factor(format(.data$Datum, \"%m\"))) %>%    dplyr::left_join(get_master(wp_master[[get_master_name(para_name)]])) %>%    dplyr::mutate(Tagesmittelwert_Pegelstand_mNN = as.numeric(.data$Pegelnullpunkt_m) + .data$Tagesmittelwert/100) %>%   ### remove -777 for messstellennummer 5867000 (few values in 2000) resulted by step above   dplyr::filter(.data$Tagesmittelwert_Pegelstand_mNN != -777) %>%   dplyr::select(- .data$Pegelnullpunkt_m) %>%    dplyr::mutate(Label = sprintf(\"%s (%s, id: %s, fluss-km: %2.2f)\",                                  .data$Name,                                 .data$Gewaesser,                                  .data$Messstellennummer,                                  as.numeric(.data$Flusskilometer)))  surfacewater_level_master_agg <- surfacewater_level_master %>%    dplyr::group_by(.data$Messstellennummer,                    .data$Decade,                   .data$Decade_Label,                    .data$Month,                    .data$Label) %>%    dplyr::summarise(Monatsmittelwert_Pegelstand_mNN = mean(.data$Tagesmittelwert_Pegelstand_mNN),                    q05 = as.numeric(quantile(.data$Tagesmittelwert_Pegelstand_mNN, probs = 0.05)),                    q95 = as.numeric(quantile(.data$Tagesmittelwert_Pegelstand_mNN, probs = 0.95)),                    )   para_name_export <- \"surface-water_level\"  readr::write_csv(surfacewater_level_master_agg, sprintf(\"%s.csv\", para_name_export ))  decades <- tibble::tibble(names = unique(surfacewater_level_master_agg$Decade_Label)[order(unique(surfacewater_level_master_agg$Decade_Label))],                           values = c('darkblue', 'blue', 'darkgreen', 'lightgreen', 'orange', 'red'))   kwb.utils::preparePdf(sprintf(\"%s.pdf\", para_name_export),                       landscape = TRUE,                       width.cm = 29.7,                        height.cm = 21)  ids <- unique(surfacewater_level_master_agg$Messstellennummer)  for(id in ids) { p1 <- surfacewater_level_master_agg %>%    dplyr::filter(.data$Messstellennummer == id)   p2 <- surfacewater_level_master %>%    dplyr::filter(.data$Year == max(.data$Year)) %>%    dplyr::group_by(.data$Messstellennummer,                    .data$Year,                   .data$Month,                    .data$Label) %>%    dplyr::summarise(Monatsmittelwert_Pegelstand_mNN = mean(.data$Tagesmittelwert_Pegelstand_mNN),                    q05 = quantile(.data$Tagesmittelwert_Pegelstand_mNN, probs = 0.05),                    q95 = quantile(.data$Tagesmittelwert_Pegelstand_mNN, probs = 0.95)) %>%    dplyr::filter(.data$Messstellennummer == id)   n_decades <- length(unique(p1$Decade_Label))  gg <- p1 %>%    ggplot2::ggplot(mapping = ggplot2::aes(x = as.integer(.data$Month),                                           y = .data$Monatsmittelwert_Pegelstand_mNN,                                          col = as.factor(.data$Decade_Label))) +    #ggplot2::geom_point(alpha = 0.5) +    ggplot2::geom_ribbon(ggplot2::aes_string(ymin = \"q05\",                                             ymax = \"q95\",                                             fill = \"Decade_Label\"),                         alpha = 0.1) +    kwb.impetus::scale_fill_decades(decades) +   kwb.impetus::scale_color_decades(decades) +   ggplot2::geom_point() +   ggplot2::geom_point(ggplot2::aes(x = as.integer(.data$Month),                                    y = .data$Monatsmittelwert_Pegelstand_mNN),                        data = p2,                       col = \"darkgrey\",                       alpha = 0.5,                        inherit.aes = FALSE,                       show.legend = FALSE) +   ggplot2::scale_x_continuous(breaks = 1:12, labels = 1:12, minor_breaks = NULL) +   #ggplot2::geom_boxplot() +   ggplot2::facet_wrap( ~ .data$Decade_Label,                        nrow = 1,                         ncol = n_decades) +   ggplot2::theme_bw() +    ggplot2::theme(legend.position=\"bottom\") +   ggplot2::labs(y = \"Monthly Mean Water Level (m NN)\",                  x = \"Month Number\",                  col = \"Mean\",                  fill = \"5%/95% Conf.-Interval\",                 title = unique(p1$Label))  plot(gg) } dev.off()"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/wasserportal.html","id":"surface-water-flow","dir":"Articles","previous_headings":"Surface Water","what":"Surface Water Flow","title":"Wasserportal","text":"","code":"para_name <- \"surface-water_flow\"  surfacewater_flow_master <- wp_data[[get_data_name(para_name)]] %>%    dplyr::filter(.data$Parameter == \"Durchfluss\") %>%       dplyr::mutate(Datum = as.Date(.data$Datum),                 Year = as.integer(format(.data$Datum, \"%Y\")),                  Decade = kwb.impetus::floor_decade(.data$Year),                 Decade_Label = sprintf(\"%d - %d\",                                         .data$Decade,                                         .data$Decade + 9),                 Month = as.factor(format(.data$Datum, \"%m\"))) %>%    dplyr::left_join(get_master(wp_master[[get_master_name(para_name)]])) %>%    dplyr::mutate(Label = sprintf(\"%s (%s, id: %s, fluss-km: %2.2f)\",                                  .data$Name,                                 .data$Gewaesser,                                  .data$Messstellennummer,                                  as.numeric(.data$Flusskilometer)))  surfacewater_flow_master_agg <- surfacewater_flow_master %>%     dplyr::group_by(.data$Messstellennummer,                    .data$Decade,                   .data$Decade_Label,                    .data$Month,                    .data$Label) %>%    dplyr::summarise(Monatsmittelwert = mean(.data$Tagesmittelwert),                    q05 = as.numeric(quantile(.data$Tagesmittelwert, probs = 0.05)),                    q95 = as.numeric(quantile(.data$Tagesmittelwert, probs = 0.95)),                    )   readr::write_csv(surfacewater_flow_master_agg, sprintf(\"%s.csv\", para_name))    decades <- tibble::tibble(names = unique(surfacewater_flow_master_agg$Decade_Label)[order(unique(surfacewater_flow_master_agg$Decade_Label))],                           values = c('darkblue', 'blue', 'darkgreen', 'lightgreen', 'orange', 'red'))    kwb.utils::preparePdf(sprintf(\"%s.pdf\", para_name),                       landscape = TRUE,                       width.cm = 29.7,                        height.cm = 21)  ids <- unique(surfacewater_flow_master_agg$Messstellennummer)  for(id in ids) { p1 <- surfacewater_flow_master_agg %>%    dplyr::filter(.data$Messstellennummer == id)   p2 <- surfacewater_flow_master %>%    dplyr::filter(.data$Year == max(.data$Year)) %>%    dplyr::group_by(.data$Messstellennummer,                    .data$Year,                   .data$Month,                    .data$Label) %>%    dplyr::summarise(Monatsmittelwert = mean(.data$Tagesmittelwert),                    q05 = quantile(.data$Tagesmittelwert, probs = 0.05),                    q95 = quantile(.data$Tagesmittelwert, probs = 0.95)) %>%    dplyr::filter(.data$Messstellennummer == id)   n_decades <- length(unique(p1$Decade_Label))  gg <- p1 %>%    ggplot2::ggplot(mapping = ggplot2::aes(x = as.integer(.data$Month),                                           y = .data$Monatsmittelwert,                                          col = as.factor(.data$Decade_Label))) +    #ggplot2::geom_point(alpha = 0.5) +    ggplot2::geom_ribbon(ggplot2::aes_string(ymin = \"q05\",                                             ymax = \"q95\",                                             fill = \"Decade_Label\"),                         alpha = 0.1) +    kwb.impetus::scale_fill_decades(decades) +   kwb.impetus::scale_color_decades(decades) +   ggplot2::geom_point() +   ggplot2::geom_point(ggplot2::aes(x = as.integer(.data$Month),                                    y = .data$Monatsmittelwert),                        data = p2,                       col = \"darkgrey\",                       alpha = 0.5,                        inherit.aes = FALSE,                       show.legend = FALSE) +   ggplot2::scale_x_continuous(breaks = 1:12, labels = 1:12, minor_breaks = NULL) +   #ggplot2::geom_boxplot() +   ggplot2::facet_wrap( ~ .data$Decade_Label,                        nrow = 1,                         ncol = n_decades) +   ggplot2::theme_bw() +    ggplot2::theme(legend.position=\"bottom\") +   ggplot2::labs(y = \"Monthly mean Surface Water Flow (m\\u00B3/s)\",                  x = \"Month Number\",                  col = \"Mean\",                  fill = \"5%/95% Conf.-Interval\",                 title = unique(p1$Label))  plot(gg) } dev.off()"},{"path":[]},{"path":"https://kwb-r.github.io/kwb.impetus/articles/wasserportal.html","id":"grundwater-level","dir":"Articles","previous_headings":"Groundwater","what":"Grundwater Level","title":"Wasserportal","text":"","code":"para_name <- \"groundwater_level\"   groundwater_level_master <- wp_data[[get_data_name(para_name)]] %>%    dplyr::filter(.data$Parameter == \"GW-Stand\") %>%       dplyr::mutate(Datum = as.Date(.data$Datum),                 Year = as.integer(format(.data$Datum, \"%Y\")),                  Decade = kwb.impetus::floor_decade(.data$Year),                 Decade_Label = sprintf(\"%d - %d\",                                         .data$Decade,                                         .data$Decade + 9),                 Month = as.factor(format(.data$Datum, \"%m\"))) %>%    dplyr::left_join(get_master(wp_master[[get_master_name(para_name)]])) %>%    dplyr::mutate(Label = sprintf(\"%s (%s, %s, gok: %.1f m, fok-fuk: %.1f-%.1f m)\",                                  .data$Messstellennummer,                                 .data$Bezirk,                                  .data$Grundwasserleiter,                                  as.double(.data$Gelaendeoberkante_GOK_m_ue_NHN),                                 as.double(.data$Filteroberkante_m_u_GOK),                                  as.double(.data$Filterunterkante_m_u_GOK)))  groundwater_level_master_agg <- groundwater_level_master %>%     dplyr::group_by(.data$Messstellennummer,                    .data$Decade,                   .data$Decade_Label,                    .data$Month,                    .data$Label) %>%    dplyr::summarise(Monatsmittelwert = mean(.data$Messwert),                    q05 = as.numeric(quantile(.data$Messwert, probs = 0.05)),                    q95 = as.numeric(quantile(.data$Messwert, probs = 0.95)),                    )   readr::write_csv(groundwater_level_master_agg, sprintf(\"%s.csv\", para_name))  decades <- tibble::tibble(names = unique(groundwater_level_master_agg$Decade_Label)[order(unique(groundwater_level_master_agg$Decade_Label))],                           values = c('darkblue', 'blue', 'darkgreen', 'lightgreen', 'orange', 'red'))    kwb.utils::preparePdf(sprintf(\"%s.pdf\", para_name),                       landscape = TRUE,                       width.cm = 29.7,                        height.cm = 21)  ids <- unique(groundwater_level_master_agg$Messstellennummer)  for(id in ids) { p1 <- groundwater_level_master_agg %>%    dplyr::filter(.data$Messstellennummer == id)   p2 <- groundwater_level_master %>%    dplyr::filter(.data$Year == max(.data$Year)) %>%    dplyr::group_by(.data$Messstellennummer,                    .data$Year,                   .data$Month,                    .data$Label) %>%    dplyr::summarise(Monatsmittelwert = mean(.data$Messwert),                    q05 = quantile(.data$Messwert, probs = 0.05),                    q95 = quantile(.data$Messwert, probs = 0.95)) %>%    dplyr::filter(.data$Messstellennummer == id)   n_decades <- length(unique(p1$Decade_Label))  gg <- p1 %>%    ggplot2::ggplot(mapping = ggplot2::aes(x = as.integer(.data$Month),                                           y = .data$Monatsmittelwert,                                          col = as.factor(.data$Decade_Label))) +    #ggplot2::geom_point(alpha = 0.5) +    ggplot2::geom_ribbon(ggplot2::aes_string(ymin = \"q05\",                                             ymax = \"q95\",                                             fill = \"Decade_Label\"),                         alpha = 0.1) +    kwb.impetus::scale_fill_decades(decades) +   kwb.impetus::scale_color_decades(decades) +   ggplot2::geom_point() +   ggplot2::geom_point(ggplot2::aes(x = as.integer(.data$Month),                                    y = .data$Monatsmittelwert),                        data = p2,                       col = \"darkgrey\",                       alpha = 0.5,                        inherit.aes = FALSE,                       show.legend = FALSE) +   ggplot2::scale_x_continuous(breaks = 1:12, labels = 1:12, minor_breaks = NULL) +   #ggplot2::geom_boxplot() +   ggplot2::facet_wrap( ~ .data$Decade_Label,                        nrow = 1,                         ncol = n_decades) +   ggplot2::theme_bw() +    ggplot2::theme(legend.position=\"bottom\") +   ggplot2::labs(y = \"Monthly Mean Groundwater Level (m NN)\",                  x = \"Month Number\",                  col = \"Month\",                  fill = \"5%/95% Conf.-Interval\",                 title = unique(p1$Label))  plot(gg) } dev.off()"},{"path":"https://kwb-r.github.io/kwb.impetus/articles/wasserportal.html","id":"download","dir":"Articles","previous_headings":"","what":"Download","title":"Wasserportal","text":"plots created code exported pdf files, available download :","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/articles/wasserportal.html","id":"csv","dir":"Articles","previous_headings":"Download","what":"CSV","title":"Wasserportal","text":"Surface Water surface-water_level.csv surface-water_flow.csv Groundwater groundwater_level.csv","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/articles/wasserportal.html","id":"pdf","dir":"Articles","previous_headings":"Download","what":"PDF","title":"Wasserportal","text":"Surface Water surface-water_level.pdf surface-water_flow.pdf Groundwater groundwater_level.pdf","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Michael Rustler. Author, maintainer. . Funder. . Copyright holder.","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Rustler M (2022). kwb.impetus: R Package Functions Used Project IMPETUS. R package version 0.0.0.9000, https://github.com/KWB-R/kwb.impetus.","code":"@Manual{,   title = {kwb.impetus: R Package with Functions Used in Project IMPETUS},   author = {Michael Rustler},   year = {2022},   note = {R package version 0.0.0.9000},   url = {https://github.com/KWB-R/kwb.impetus}, }"},{"path":"https://kwb-r.github.io/kwb.impetus/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"R Package with Functions Used in Project IMPETUS","text":"installing latest release R package run following code :","code":"# Enable repository from kwb-r options(repos = c(   kwbr = 'https://kwb-r.r-universe.dev',   CRAN = 'https://cloud.r-project.org'))    # Download and install 'kwb.impetus in R install.packages('kwb.impetus')  # Browse the 'kwb.impetus manual pages help(package = 'kwb.impetus')"},{"path":"https://kwb-r.github.io/kwb.impetus/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"R Package with Functions Used in Project IMPETUS","text":"Checkout Data Analysis workflows Berlin case study site: Deutscher Wetterdienst (DWD) using monthly open-data precitiptation (1881-01 - 2022-08) potential evaporation (1991-01 - 2022-08). details dataset pre-processed, see : dwd_berlin_monthly Wasserportal surface water level/flow groundwater level Berlin (https://wasserportal.berlin.de).","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/decade_label.html","id":null,"dir":"Reference","previous_headings":"","what":"Label for Decade Year Range — decade_label","title":"Label for Decade Year Range — decade_label","text":"Label Decade Year Range","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/decade_label.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Label for Decade Year Range — decade_label","text":"","code":"decade_label(decade)"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/decade_label.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Label for Decade Year Range — decade_label","text":"decade start decade integer, e.g. 1990L","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/decade_label.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Label for Decade Year Range — decade_label","text":"character string, e.g. \"1990 - 1999\"","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/decade_ribbons.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2 ribbon between q05 and q95 — decade_ribbons","title":"ggplot2 ribbon between q05 and q95 — decade_ribbons","text":"ggplot2 ribbon q05 q95","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/decade_ribbons.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2 ribbon between q05 and q95 — decade_ribbons","text":"","code":"decade_ribbons(alpha = 0.1)"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/decade_ribbons.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2 ribbon between q05 and q95 — decade_ribbons","text":"alpha passed geom_ribbon","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/decades_tibble.html","id":null,"dir":"Reference","previous_headings":"","what":"Tibble with Decade Names and Values — decades_tibble","title":"Tibble with Decade Names and Values — decades_tibble","text":"Tibble Decade Names Values","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/decades_tibble.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tibble with Decade Names and Values — decades_tibble","text":"","code":"decades_tibble(   decade_labels,   colors = c(\"darkblue\", \"blue\", \"darkgreen\", \"lightgreen\", \"orange\", \"red\") )"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/decades_tibble.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tibble with Decade Names and Values — decades_tibble","text":"decade_labels decade labels colors colour values","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/decades_tibble.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tibble with Decade Names and Values — decades_tibble","text":"tibble columns names values","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/download_gfz_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Download GFZ Model Layers — download_gfz_model","title":"Download GFZ Model Layers — download_gfz_model","text":"Download GFZ Model Layers","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/download_gfz_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download GFZ Model Layers — download_gfz_model","text":"","code":"download_gfz_model(target_dir = tempdir())"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/download_gfz_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download GFZ Model Layers — download_gfz_model","text":"target_dir target directory extract files (default: tempdir())","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/download_gfz_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download GFZ Model Layers — download_gfz_model","text":"extracts GFZ model layers target directory","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/dwd_berlin_monthly.html","id":null,"dir":"Reference","previous_headings":"","what":"DWD Dataset (Precipitation and Potential Evaporation) Averaged for Berlin — dwd_berlin_monthly","title":"DWD Dataset (Precipitation and Potential Evaporation) Averaged for Berlin — dwd_berlin_monthly","text":"dataset containing precipitation potential diamonds.","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/dwd_berlin_monthly.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DWD Dataset (Precipitation and Potential Evaporation) Averaged for Berlin — dwd_berlin_monthly","text":"","code":"dwd_berlin_monthly"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/dwd_berlin_monthly.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"DWD Dataset (Precipitation and Potential Evaporation) Averaged for Berlin — dwd_berlin_monthly","text":"data frame 3852 rows 12 variables: parameter_name self-defined name parameter parameter original DWD parameter name (required requests) file name raw data file year year month month mean spatial mean value month sd spatial standard deviation value month min spatial minimum value month max spatial maximum value month n_values number 1x1km2 grids used spatial statistics calculation parameter parameter name url full url raw data file","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/dwd_berlin_monthly.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"DWD Dataset (Precipitation and Potential Evaporation) Averaged for Berlin — dwd_berlin_monthly","text":"","code":"if (FALSE) { ############################################################################ #### R code used for creation of \"dwd_berlin_monthly.rds\" ############################################################################  remotes::install_github(\"kwb-r/kwb.dwd\")  library(kwb.impetus)  shape_obj <- kwb.dwd:::get_shape_of_german_region(name = \"berlin\") shape_file <- \"berlin.shp\"  shape_obj %>%   sf::st_as_sf() %>%   sf::write_sf(shape_file)  ### Plot to check if Berlin boundaries are plotted correctly. ### Set target CRS crs_target <- 4326 shape_pt <- sf::st_read(shape_file) %>%  sf::st_transform(crs = crs_target) basemap <- shape_pt %>%  leaflet::leaflet() %>%  leaflet::addTiles() %>%  leaflet::addProviderTiles(leaflet::providers$CartoDB.Positron) %>%  leaflet::addPolygons(color = \"red\", fill = FALSE) basemap yearmonth_start <- \"188101\" yearmonth_end <- \"202208\" kwb.dwd:::list_monthly_grids_germany_asc_gz(\"x\") dwd_monthly_vars <- c(#\"air temperature (mean)\" = \"air_temperature_mean\"#,  \"drought index\" = \"drought_index\",  \"evaporation, potential\" = \"evapo_p\",  \"evaporation, real\" = \"evapo_r\",  \"precipitation\" = \"precipitation\",  \"soil moisture\" = \"soil_moist\",  \"soil temperature (5 cm)\" = \"soil_temperature_5cm\" )  system.time(  dwd_berlin_monthly_list <- stats::setNames(lapply(dwd_monthly_vars, function(dwd_var) {    kwb.dwd::read_monthly_data_over_shape(      file = shape_file,      variable = dwd_var,      from = yearmonth_start,      to = yearmonth_end,      quiet = TRUE    )  }), nm = dwd_monthly_vars))   dwd_berlin_monthly <- dplyr::bind_rows(dwd_berlin_monthly_list, .id = \"parameter\")  dwd_berlin_monthly <- tibble::tibble(parameter_name = names(dwd_monthly_vars),                                      parameter = as.character(dwd_monthly_vars)) %>%    dplyr::left_join(dwd_berlin_monthly)   usethis::use_data(dwd_berlin_monthly, overwrite = TRUE)  }     # Dataset  dwd_berlin_monthly #> # A tibble: 3,852 × 11 #>    param…¹ param…² file  date        year month  mean     sd   min   max n_val…³ #>    <chr>   <chr>   <chr> <date>     <int> <int> <dbl>  <dbl> <dbl> <dbl>   <dbl> #>  1 drough… drough… grid… 1970-01-01  1970     1  7.32 0.955      5    10     902 #>  2 drough… drough… grid… 1971-01-01  1971     1  2.00 0.115      1     3     902 #>  3 drough… drough… grid… 1972-01-01  1972     1  1.99 0.0938     1     2     902 #>  4 drough… drough… grid… 1973-01-01  1973     1  2.48 0.500      2     3     902 #>  5 drough… drough… grid… 1974-01-01  1974     1  2.02 0.151      2     3     902 #>  6 drough… drough… grid… 1975-01-01  1975     1  2.87 0.332      2     3     902 #>  7 drough… drough… grid… 1976-01-01  1976     1  9.05 0.500      8    11     902 #>  8 drough… drough… grid… 1977-01-01  1977     1  2.23 0.421      2     3     902 #>  9 drough… drough… grid… 1978-01-01  1978     1  1.76 0.428      1     2     902 #> 10 drough… drough… grid… 1979-01-01  1979     1  5.10 0.528      4     7     902 #> # … with 3,842 more rows, and abbreviated variable names ¹​parameter_name, #> #   ²​parameter, ³​n_values   # Covered time period for each parameter  dwd_berlin_monthly %>%   dplyr::group_by(.data$parameter_name, .data$parameter) %>% dplyr::summarise(date_min = min(.data$date), date_max = max(.data$date)) #> `summarise()` has grouped output by 'parameter_name'. You can override using #> the `.groups` argument. #> # A tibble: 6 × 4 #> # Groups:   parameter_name [6] #>   parameter_name          parameter            date_min   date_max   #>   <chr>                   <chr>                <date>     <date>     #> 1 drought index           drought_index        1970-01-01 2022-08-01 #> 2 evaporation, potential  evapo_p              1991-01-01 2022-08-01 #> 3 evaporation, real       evapo_r              1991-01-01 2022-08-01 #> 4 precipitation           precipitation        1881-01-01 2022-08-01 #> 5 soil moisture           soil_moist           1991-01-01 2022-08-01 #> 6 soil temperature (5 cm) soil_temperature_5cm 1991-01-01 2022-08-01"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/floor_decade.html","id":null,"dir":"Reference","previous_headings":"","what":"floor to decade — floor_decade","title":"floor to decade — floor_decade","text":"floors previous decade.","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/floor_decade.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"floor to decade — floor_decade","text":"","code":"floor_decade(value)"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/floor_decade.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"floor to decade — floor_decade","text":"value year","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/floor_decade.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"floor to decade — floor_decade","text":"decade","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/floor_decade.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"floor to decade — floor_decade","text":"","code":"floor_decade(2000:2020) #>  [1] 2000 2000 2000 2000 2000 2000 2000 2000 2000 2000 2010 2010 2010 2010 2010 #> [16] 2010 2010 2010 2010 2010 2020"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/ggplot2_scale_x_continuous_12.html","id":null,"dir":"Reference","previous_headings":"","what":"Continuous x scale for months — ggplot2_scale_x_continuous_12","title":"Continuous x scale for months — ggplot2_scale_x_continuous_12","text":"Continuous x scale months","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/ggplot2_scale_x_continuous_12.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Continuous x scale for months — ggplot2_scale_x_continuous_12","text":"","code":"ggplot2_scale_x_continuous_12()"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/group_by_decade_label.html","id":null,"dir":"Reference","previous_headings":"","what":"Group by Dekade_Label — group_by_decade_label","title":"Group by Dekade_Label — group_by_decade_label","text":"Group Dekade_Label","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/group_by_decade_label.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Group by Dekade_Label — group_by_decade_label","text":"","code":"group_by_decade_label(data)"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/group_by_decade_label.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Group by Dekade_Label — group_by_decade_label","text":"data data frame","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/group_by_decade_month_label.html","id":null,"dir":"Reference","previous_headings":"","what":"Group by Decade, Decade_Label, Month, Label — group_by_decade_month_label","title":"Group by Decade, Decade_Label, Month, Label — group_by_decade_month_label","text":"Group Decade, Decade_Label, Month, Label","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/group_by_decade_month_label.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Group by Decade, Decade_Label, Month, Label — group_by_decade_month_label","text":"","code":"group_by_decade_month_label(data)"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/group_by_decade_month_label.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Group by Decade, Decade_Label, Month, Label — group_by_decade_month_label","text":"data data frame","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/group_by_site_decade_month_label.html","id":null,"dir":"Reference","previous_headings":"","what":"Group by Messstellennummer, Decade, Decade_Label, Month, Label — group_by_site_decade_month_label","title":"Group by Messstellennummer, Decade, Decade_Label, Month, Label — group_by_site_decade_month_label","text":"Group Messstellennummer, Decade, Decade_Label, Month, Label","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/group_by_site_decade_month_label.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Group by Messstellennummer, Decade, Decade_Label, Month, Label — group_by_site_decade_month_label","text":"","code":"group_by_site_decade_month_label(data)"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/group_by_site_decade_month_label.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Group by Messstellennummer, Decade, Decade_Label, Month, Label — group_by_site_decade_month_label","text":"data data frame","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/group_by_site_year_month_label.html","id":null,"dir":"Reference","previous_headings":"","what":"Group by Messstellennummer, Year, Month, Label — group_by_site_year_month_label","title":"Group by Messstellennummer, Year, Month, Label — group_by_site_year_month_label","text":"Group Messstellennummer, Year, Month, Label","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/group_by_site_year_month_label.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Group by Messstellennummer, Year, Month, Label — group_by_site_year_month_label","text":"","code":"group_by_site_year_month_label(data)"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/group_by_site_year_month_label.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Group by Messstellennummer, Year, Month, Label — group_by_site_year_month_label","text":"data data frame","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/group_by_year_month.html","id":null,"dir":"Reference","previous_headings":"","what":"Group by Year, Month — group_by_year_month","title":"Group by Year, Month — group_by_year_month","text":"Group Year, Month","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/group_by_year_month.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Group by Year, Month — group_by_year_month","text":"","code":"group_by_year_month(data)"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/group_by_year_month.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Group by Year, Month — group_by_year_month","text":"data data frame","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/numeric_quantile.html","id":null,"dir":"Reference","previous_headings":"","what":"Unnamed Quantile Value — numeric_quantile","title":"Unnamed Quantile Value — numeric_quantile","text":"Unnamed Quantile Value","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/numeric_quantile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Unnamed Quantile Value — numeric_quantile","text":"","code":"numeric_quantile(x, prob)"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/numeric_quantile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Unnamed Quantile Value — numeric_quantile","text":"x vector numeric prob probability passed quantile","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/plot_gfz_layer.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot GFZ Model Raster Layer — plot_gfz_layer","title":"Plot GFZ Model Raster Layer — plot_gfz_layer","text":"Plot GFZ Model Raster Layer","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/plot_gfz_layer.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot GFZ Model Raster Layer — plot_gfz_layer","text":"","code":"plot_gfz_layer(layer)"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/plot_gfz_layer.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot GFZ Model Raster Layer — plot_gfz_layer","text":"layer layer retrieved read_gfz_layers","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/plot_gfz_layer.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot GFZ Model Raster Layer — plot_gfz_layer","text":"plot raster layer","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/q_surface_water.html","id":null,"dir":"Reference","previous_headings":"","what":"Surface Water Flows (from Niedrigwasserbericht 2018-2020 by SenUVK Berlin) — q_surface_water","title":"Surface Water Flows (from Niedrigwasserbericht 2018-2020 by SenUVK Berlin) — q_surface_water","text":"Extracted parts table page 16 Niedrigwasserbericht 2018-2020 SenUVK Berlin. Contains flows inflows Berlin (.e. data Sophienwerder Muehlendammschleuse ware imported)","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/q_surface_water.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Surface Water Flows (from Niedrigwasserbericht 2018-2020 by SenUVK Berlin) — q_surface_water","text":"","code":"q_surface_water"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/q_surface_water.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Surface Water Flows (from Niedrigwasserbericht 2018-2020 by SenUVK Berlin) — q_surface_water","text":"data frame 6 rows 10 variables: fliessgewaesser name surface water pegel name monitoring station mq.1991_2017 MQ period 1991-2017 (m3/s)) mnq.1991_2017 MQ period 1991-2017 (m3/s) nq.1991_2017 MQ period 1991-2017 (m3/s)) nnq.value NNQ value (m3/s) nnq.date Date nnq.value (NA \"often\" !) mq.2018 MQ year 2018 (m3/s) mq.2019 MQ year 2019 (m3/s) mq.2020 MQ year 2020 (m3/s)","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/q_surface_water.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Surface Water Flows (from Niedrigwasserbericht 2018-2020 by SenUVK Berlin) — q_surface_water","text":"https://www.berlin.de/sen/uvk/_assets/umwelt/wasser-und-geologie/niedrigwasser/niedrigwasser_berlin_2018-2020.pdf#page=16","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/q_surface_water.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Surface Water Flows (from Niedrigwasserbericht 2018-2020 by SenUVK Berlin) — q_surface_water","text":"","code":"kwb.impetus::q_surface_water #> # A tibble: 6 × 10 #>   fliess…¹ pegel mq.19…² mnq.1…³ nq.19…⁴ nnq.v…⁵ nnq.d…⁶ mq.2018 mq.2019 mq.2020 #>   <chr>    <chr>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>   <dbl>   <dbl> #> 1 Dahme    Neue…    9.13    0.69    0.2     0.03 1954-0…   11.4     4.38    2.82 #> 2 Oder-Sp… Wern…    7.9     0.95    0.54    0.1  1905-0…    5.44    2.95    2.64 #> 3 Spree    Groß…   12.3     3.04    1.01    1.01 2001-0…    9.37    9.33    9.03 #> 4 Havel    Borg…   12.3     2.69    1.7     1.66 2009-0…   16.9     6.97    7.71 #> 5 Wuhle    Am B…    0.51    0.23    0.06    0.06 2014-0…    0.3     0.16    0.17 #> 6 Freders… Hege…    0.2     0       0       0    NA         0       0       0    #> # … with abbreviated variable names ¹​fliessgewaesser, ²​mq.1991_2017, #> #   ³​mnq.1991_2017, ⁴​nq.1991_2017, ⁵​nnq.value, ⁶​nnq.date"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/read_gfz_layer.html","id":null,"dir":"Reference","previous_headings":"","what":"Reads a single GFZ Model Layer — read_gfz_layer","title":"Reads a single GFZ Model Layer — read_gfz_layer","text":"Reads single GFZ Model Layer","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/read_gfz_layer.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reads a single GFZ Model Layer — read_gfz_layer","text":"","code":"read_gfz_layer(path, as_raster)"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/read_gfz_layer.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reads a single GFZ Model Layer — read_gfz_layer","text":"path path GFZ Model Layer as_raster convert raster (default: TRUE)","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/read_gfz_layer.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reads a single GFZ Model Layer — read_gfz_layer","text":"imported layer file","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/read_gfz_layers.html","id":null,"dir":"Reference","previous_headings":"","what":"Reads multiple GFZ Model Layers — read_gfz_layers","title":"Reads multiple GFZ Model Layers — read_gfz_layers","text":"Reads multiple GFZ Model Layers","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/read_gfz_layers.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reads multiple GFZ Model Layers — read_gfz_layers","text":"","code":"read_gfz_layers(   dir_model_data,   type = \"elevation\",   as_raster = TRUE,   dbg = TRUE )"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/read_gfz_layers.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reads multiple GFZ Model Layers — read_gfz_layers","text":"dir_model_data path GFZ Model Layer Data retrieved  download_gfz_model as_raster convert raster (default: TRUE) dbg print debug messaages (default: TRUE)","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/read_gfz_layers.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reads multiple GFZ Model Layers — read_gfz_layers","text":"imported layer files","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/round_to_decade.html","id":null,"dir":"Reference","previous_headings":"","what":"round to decade — round_to_decade","title":"round to decade — round_to_decade","text":"rounds next decade end year >=5 floors previous decade end year <5.","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/round_to_decade.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"round to decade — round_to_decade","text":"","code":"round_to_decade(values)"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/round_to_decade.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"round to decade — round_to_decade","text":"values year","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/round_to_decade.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"round to decade — round_to_decade","text":"decade","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/round_to_decade.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"round to decade — round_to_decade","text":"","code":"round_to_decade(2000:2020) #>  [1] 2000 2000 2000 2000 2000 2010 2010 2010 2010 2010 2010 2010 2010 2010 2010 #> [16] 2020 2020 2020 2020 2020 2020"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/scale_color_decades.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2: scale color decades — scale_color_decades","title":"ggplot2: scale color decades — scale_color_decades","text":"ggplot2: scale color decades","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/scale_color_decades.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2: scale color decades — scale_color_decades","text":"","code":"scale_color_decades(decades, ...)"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/scale_color_decades.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2: scale color decades — scale_color_decades","text":"decades decades ... additional arguments passed xxx","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/scale_color_decades.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggplot2: scale color decades — scale_color_decades","text":"re-scales ggplot2","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/scale_fill_decades.html","id":null,"dir":"Reference","previous_headings":"","what":"ggplot2: scale fill decades — scale_fill_decades","title":"ggplot2: scale fill decades — scale_fill_decades","text":"ggplot2: scale fill decades","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/scale_fill_decades.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ggplot2: scale fill decades — scale_fill_decades","text":"","code":"scale_fill_decades(decades, ...)"},{"path":"https://kwb-r.github.io/kwb.impetus/reference/scale_fill_decades.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ggplot2: scale fill decades — scale_fill_decades","text":"decades decades ... additional arguments passed xxx","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/reference/scale_fill_decades.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ggplot2: scale fill decades — scale_fill_decades","text":"re-scales ggplot2","code":""},{"path":"https://kwb-r.github.io/kwb.impetus/news/index.html","id":"kwbimpetus-0009000","dir":"Changelog","previous_headings":"","what":"kwb.impetus 0.0.0.9000","title":"kwb.impetus 0.0.0.9000","text":"Data Analysis: Add workfow Infographic (KWB Annual Report) published upcoming KWB annual report 2021/2022. Added three workflows data analysis (monthly values grouped decades, month mean well 5% 95% confidence intervals given). three workflows based open-data Wasserportal Berlin covered data period starts 1970-01-01 recent year. Time resolution varied mostly daily quantitative surface/groundwater monitoring stations. summarized monthly means. Deutscher Wetterdienst (DWD) spatially averaged parameters (e.g. precipitation, evaporation: real potential Berlin (see DWD (Grid Data)). longest time period data available precipitation, starts 1881-01-01 ends 2022-08-31. details checkout dataset dwd_berlin_monthly provided within R package. addition also DWD (Climatic Water Balance) workflow available subtracting evaporation, real/potential precipitation (based DWD (Grid Data)). : Added NEWS.md file track changes package. see https://style.tidyverse.org/news.html writing good NEWS.md","code":""}]
